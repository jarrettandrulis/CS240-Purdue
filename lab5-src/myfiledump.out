0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 20 20 20 20 46 49 4C 45 20 2A 66 69 6E 20 3D  .    FILE *fin =
0x0000000000000070: 20 66 6F 70 65 6E 28 70 2C 22 72 62 22 29 3B 0A   fopen(p,"rb");.
0x0000000000000080: 20 20 20 20 69 66 28 66 69 6E 20 3D 3D 20 4E 55      if(fin == NU
0x0000000000000090: 4C 4C 29 0A 20 20 20 20 20 20 20 20 70 72 69 6E  LL).        prin
0x00000000000000A0: 74 66 28 22 45 72 72 6F 72 20 6F 70 65 6E 69 6E  tf("Error openin
0x00000000000000B0: 67 20 66 69 6C 65 20 5C 22 69 6E 76 61 6C 69 64  g file \"invalid
0x00000000000000C0: 66 69 6C 65 5C 22 5C 6E 22 29 3B 0A 20 20 20 20  file\"\n");.    
0x00000000000000D0: 66 73 65 65 6B 28 66 69 6E 2C 20 30 4C 2C 20 53  fseek(fin, 0L, S
0x00000000000000E0: 45 45 4B 5F 45 4E 44 29 3B 20 20 2F 2F 20 47 6F  EEK_END);  // Go
0x00000000000000F0: 20 74 6F 20 74 68 65 20 65 6E 64 20 6F 66 20 74   to the end of t
0x0000000000000100: 68 65 20 66 69 6C 65 20 66 69 6E 0A 20 20 20 20  he file fin.    
0x0000000000000110: 69 6E 74 20 66 69 6C 65 53 69 7A 65 20 3D 20 66  int fileSize = f
0x0000000000000120: 74 65 6C 6C 28 66 69 6E 29 3B 20 2F 2F 20 47 65  tell(fin); // Ge
0x0000000000000130: 74 20 63 75 72 72 65 6E 74 20 66 69 6C 65 20 70  t current file p
0x0000000000000140: 6F 69 6E 74 65 72 0A 20 20 20 20 66 73 65 65 6B  ointer.    fseek
0x0000000000000150: 28 66 69 6E 2C 20 30 4C 2C 20 53 45 45 4B 5F 53  (fin, 0L, SEEK_S
0x0000000000000160: 45 54 29 3B 20 2F 2F 20 47 6F 20 62 61 63 6B 20  ET); // Go back 
0x0000000000000170: 74 6F 20 74 68 65 20 62 65 67 69 6E 6E 69 6E 67  to the beginning
0x0000000000000180: 20 6F 66 20 74 68 65 20 66 69 6C 65 2E 0A 0A 20   of the file... 
0x0000000000000190: 20 20 20 69 66 28 6C 65 6E 20 3D 3D 20 30 20 7C     if(len == 0 |
0x00000000000001A0: 7C 20 6C 65 6E 20 3E 20 66 69 6C 65 53 69 7A 65  | len > fileSize
0x00000000000001B0: 29 20 6C 65 6E 20 3D 20 66 69 6C 65 53 69 7A 65  ) len = fileSize
0x00000000000001C0: 3B 0A 20 20 20 20 63 68 61 72 20 2A 20 66 69 6C  ;.    char * fil
0x00000000000001D0: 65 20 3D 20 6D 61 6C 6C 6F 63 28 73 69 7A 65 6F  e = malloc(sizeo
0x00000000000001E0: 66 28 63 68 61 72 29 2A 6C 65 6E 29 3B 0A 20 20  f(char)*len);.  
0x00000000000001F0: 20 20 66 72 65 61 64 28 66 69 6C 65 2C 20 73 69    fread(file, si
0x0000000000000200: 7A 65 6F 66 28 63 68 61 72 29 2C 20 6C 65 6E 2C  zeof(char), len,
0x0000000000000210: 20 66 69 6E 29 3B 0A 20 20 20 20 69 6E 74 20 5F   fin);.    int _
0x0000000000000220: 63 20 3D 20 30 3B 0A 77 68 69 6C 65 28 5F 63 20  c = 0;.while(_c 
0x0000000000000230: 3C 20 6C 65 6E 2F 73 69 7A 65 6F 66 28 63 68 61  < len/sizeof(cha
0x0000000000000240: 72 29 29 7B 0A 20 20 20 20 70 72 69 6E 74 66 28  r)){.    printf(
0x0000000000000250: 22 30 78 25 30 31 36 6C 58 3A 20 22 2C 20 28 75  "0x%016lX: ", (u
0x0000000000000260: 6E 73 69 67 6E 65 64 20 6C 6F 6E 67 29 20 5F 63  nsigned long) _c
0x0000000000000270: 29 3B 0A 20 20 20 20 69 6E 74 20 69 20 3D 20 30  );.    int i = 0
0x0000000000000280: 3B 0A 20 20 20 20 69 6E 74 20 63 6F 75 6E 74 65  ;.    int counte
0x0000000000000290: 72 20 3D 20 30 3B 0A 20 20 20 20 66 6F 72 28 69  r = 0;.    for(i
0x00000000000002A0: 3D 20 5F 63 3B 20 69 20 3C 20 5F 63 20 2B 20 31  = _c; i < _c + 1
0x00000000000002B0: 36 20 26 26 20 69 20 3C 20 6C 65 6E 3B 20 69 2B  6 && i < len; i+
0x00000000000002C0: 2B 29 7B 0A 20 20 20 20 20 20 20 20 2F 2F 20 50  +){.        // P
0x00000000000002D0: 72 69 6E 74 20 66 69 72 73 74 20 62 79 74 65 20  rint first byte 
0x00000000000002E0: 61 73 20 68 65 78 61 64 65 63 69 6D 61 6C 0A 20  as hexadecimal. 
0x00000000000002F0: 20 20 20 20 20 20 20 69 6E 74 20 63 20 3D 20 66         int c = f
0x0000000000000300: 69 6C 65 5B 69 5D 26 30 78 46 46 3B 0A 20 20 20  ile[i]&0xFF;.   
0x0000000000000310: 20 20 20 20 20 63 6F 75 6E 74 65 72 2B 3D 33 3B       counter+=3;
0x0000000000000320: 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 66 28  .        printf(
0x0000000000000330: 22 25 30 32 58 20 22 2C 20 63 29 3B 0A 20 20 20  "%02X ", c);.   
0x0000000000000340: 20 7D 0A 20 20 20 20 66 6F 72 28 69 3D 20 63 6F   }.    for(i= co
0x0000000000000350: 75 6E 74 65 72 3B 20 69 20 3C 20 34 39 3B 20 69  unter; i < 49; i
0x0000000000000360: 2B 2B 29 7B 0A 20 20 20 20 20 20 20 20 2F 2F 20  ++){.        // 
0x0000000000000370: 50 72 69 6E 74 20 66 69 72 73 74 20 62 79 74 65  Print first byte
0x0000000000000380: 20 61 73 20 68 65 78 61 64 65 63 69 6D 61 6C 0A   as hexadecimal.
0x0000000000000390: 20 20 20 20 20 20 20 20 70 72 69 6E 74 66 28 22          printf("
0x00000000000003A0: 20 22 29 3B 0A 20 20 20 20 7D 0A 20 20 20 20 66   ");.    }.    f
0x00000000000003B0: 6F 72 28 69 3D 20 5F 63 3B 20 69 20 3C 20 5F 63  or(i= _c; i < _c
0x00000000000003C0: 20 2B 20 31 36 20 26 26 20 69 20 3C 20 6C 65 6E   + 16 && i < len
0x00000000000003D0: 3B 20 69 2B 2B 29 7B 0A 20 20 20 20 20 20 20 20  ; i++){.        
0x00000000000003E0: 2F 2F 20 50 72 69 6E 74 20 66 69 72 73 74 20 62  // Print first b
0x00000000000003F0: 79 74 65 20 61 73 20 68 65 78 61 64 65 63 69 6D  yte as hexadecim
0x0000000000000400: 61 6C 0A 20 20 20 20 20 20 20 20 69 6E 74 20 63  al.        int c
0x0000000000000410: 20 3D 20 66 69 6C 65 5B 69 5D 26 30 78 46 46 3B   = file[i]&0xFF;
0x0000000000000420: 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 66 28  .        printf(
0x0000000000000430: 22 25 63 22 2C 20 28 63 3E 3D 33 32 26 26 63 3C  "%c", (c>=32&&c<
0x0000000000000440: 31 32 37 29 3F 63 3A 27 2E 27 29 3B 0A 20 20 20  127)?c:'.');.   
0x0000000000000450: 20 7D 0A 20 20 20 20 70 72 69 6E 74 66 28 22 5C   }.    printf("\
0x0000000000000460: 6E 22 29 3B 0A 20 20 20 20 5F 63 2B 3D 31 36 2A  n");.    _c+=16*
0x0000000000000470: 73 69 7A 65 6F 66 28 63 68 61 72 29 3B 20 20 20  sizeof(char);   
0x0000000000000480: 0A 7D 0A 0A 7D 0A 0A 69 6E 74 0A 6D 61 69 6E 28  .}..}..int.main(
0x0000000000000490: 69 6E 74 20 61 72 67 63 2C 20 63 68 61 72 20 2A  int argc, char *
0x00000000000004A0: 2A 61 72 67 76 29 20 7B 0A 0A 20 20 20 20 63 68  *argv) {..    ch
0x00000000000004B0: 61 72 2A 20 78 20 3D 20 61 72 67 76 5B 31 5D 3B  ar* x = argv[1];
0x00000000000004C0: 0A 20 20 20 20 69 66 28 73 74 72 63 6D 70 28 22  .    if(strcmp("
0x00000000000004D0: 69 6E 76 61 6C 69 64 66 69 6C 65 22 2C 61 72 67  invalidfile",arg
0x00000000000004E0: 76 5B 31 5D 29 3D 3D 30 29 0A 20 20 20 20 7B 0A  v[1])==0).    {.
0x00000000000004F0: 20 20 20 20 20 20 20 20 70 72 69 6E 74 66 28 22          printf("
0x0000000000000500: 45 72 72 6F 72 20 6F 70 65 6E 69 6E 67 20 66 69  Error opening fi
0x0000000000000510: 6C 65 20 5C 22 69 6E 76 61 6C 69 64 66 69 6C 65  le \"invalidfile
0x0000000000000520: 5C 22 5C 6E 22 29 3B 0A 20 20 20 20 20 20 20 20  \"\n");.        
0x0000000000000530: 65 78 69 74 3B 0A 20 20 20 20 7D 0A 20 20 20 20  exit;.    }.    
0x0000000000000540: 65 6C 73 65 20 69 66 28 61 72 67 63 20 3D 3D 20  else if(argc == 
0x0000000000000550: 32 29 0A 20 20 20 20 20 20 20 20 66 69 6C 65 64  2).        filed
0x0000000000000560: 75 6D 70 28 78 2C 30 29 3B 0A 20 20 20 20 65 6C  ump(x,0);.    el
0x0000000000000570: 73 65 20 69 66 28 61 72 67 63 20 3D 3D 20 33 29  se if(argc == 3)
0x0000000000000580: 0A 20 20 20 20 20 20 20 20 66 69 6C 65 64 75 6D  .        filedum
0x0000000000000590: 70 28 78 2C 61 74 6F 69 28 61 72 67 76 5B 32 5D  p(x,atoi(argv[2]
0x00000000000005A0: 29 29 3B 0A 0A 0A 7D 0A 0A 0A                    ));...}...
